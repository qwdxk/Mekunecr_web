name: 处理登录申请

on:
  workflow_dispatch:
    inputs:
      username:
        description: '用户名'
        required: true
      client_id:
        description: '申请ID'
        required: true

jobs:
  process-login:
    runs-on: ubuntu-latest
    
    steps:
    - name: 检出代码
      uses: actions/checkout@v4

    - name: 处理申请
      run: |
        echo "处理登录申请..."
        
        # 创建申请文件（不修改现有文件）
        mkdir -p applications
        
        cat > "applications/${{ github.event.inputs.client_id }}.json" << EOF
        {
          "username": "${{ github.event.inputs.username }}",
          "client_id": "${{ github.event.inputs.client_id }}",
          "status": "pending",
          "received_at": "$(date -Iseconds)"
        }
        EOF
        
        echo "申请文件已创建"

    - name: 上传申请文件
      uses: actions/upload-artifact@v4
      with:
        name: login-application
        path: applications/
        retention-days: 1
